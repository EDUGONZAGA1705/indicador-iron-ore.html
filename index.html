<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Indicadores IRON ORE</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: 'Segoe UI', sans-serif;
      background: #f5f7f9;
      padding: 20px;
      display: flex;
      flex-wrap: wrap;
      gap: 16px;
    }
    .widget {
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.08);
      padding: 16px;
      width: 300px;
      box-sizing: border-box;
    }
    .top-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .symbol {
      font-weight: bold;
      font-size: 16px;
    }
    .company {
      font-size: 12px;
      color: #888;
    }
    .price {
      font-size: 28px;
      font-weight: 600;
      margin-top: 10px;
    }
    .change {
      font-size: 14px;
    }
    .chart-container {
      margin-top: 12px;
    }
    canvas {
      width: 100% !important;
      height: 100px !important;
      display: block;
    }
    .refresh-icon {
      cursor: pointer;
      font-size: 16px;
      opacity: 0.6;
      transition: opacity 0.2s;
    }
    .refresh-icon:hover {
      opacity: 1;
    }
    .refresh-icon::before {
      content: "⟳";
    }
  </style>
</head>
<body>

  <div id="cards-container"></div>

  <script>
    const indicadores = [
      { symbol: "PRC62", nome: "Preço Minério 62%", last: 277.55, variacaoAbs: 0.58, variacaoPerc: 0.21 },
      { symbol: "FRETE", nome: "Frete Marítimo", last: 34.22, variacaoAbs: -0.35, variacaoPerc: -1.01 },
      { symbol: "FX", nome: "Dólar Comercial", last: 5.14, variacaoAbs: 0.02, variacaoPerc: 0.39 }
    ];

    function gerarHistorico(symbol) {
      const base = Math.random() * 100 + 200;
      return Array.from({ length: 12 }, (_, i) => parseFloat((base + Math.random() * 10 - 5).toFixed(2)));
    }

    function criarCard(indicador) {
      const container = document.getElementById('cards-container');
      const card = document.createElement('div');
      card.className = 'widget';

      const variacaoPositiva = indicador.variacaoAbs >= 0;
      const cor = variacaoPositiva ? '#28a745' : '#dc3545';

      card.innerHTML = `
        <div class="top-row">
          <div>
            <div class="symbol">${indicador.symbol}</div>
            <div class="company">${indicador.nome}</div>
          </div>
          <div class="refresh-icon" onclick="atualizarCard('${indicador.symbol}')"></div>
        </div>
        <div class="price" id="price-${indicador.symbol}">${indicador.last}</div>
        <div class="change" id="change-${indicador.symbol}" style="color:${cor}">
          ${indicador.variacaoAbs >= 0 ? '+' : ''}${indicador.variacaoAbs} (${indicador.variacaoPerc}%)
        </div>
        <div class="chart-container">
          <canvas id="chart-${indicador.symbol}"></canvas>
        </div>
      `;

      container.appendChild(card);
      renderizarGrafico(indicador.symbol, gerarHistorico(indicador.symbol), variacaoPositiva);
    }

    function renderizarGrafico(id, dados, positivo) {
      const ctx = document.getElementById(`chart-${id}`).getContext('2d');
      const grad = ctx.createLinearGradient(0, 0, 0, 120);
      grad.addColorStop(0, positivo ? 'rgba(40,167,69,0.4)' : 'rgba(220,53,69,0.4)');
      grad.addColorStop(1, 'rgba(0,0,0,0)');

      new Chart(ctx, {
        type: 'line',
        data: {
          labels: [...Array(dados.length).keys()].map(i => `M-${i + 1}`),
          datasets: [{
            data: dados,
            borderColor: positivo ? '#28a745' : '#dc3545',
            backgroundColor: grad,
            fill: true,
            tension: 0,
            pointRadius: 0
          }]
        },
        options: {
          plugins: { legend: { display: false } },
          scales: { x: { display: false }, y: { display: false } }
        }
      });
    }

    function atualizarCard(symbol) {
      alert(`Atualização simulada para: ${symbol}`);
      // Aqui você pode fazer fetch real dos dados atualizados
    }

    indicadores.forEach(criarCard);
  </script>
</body>
</html>
